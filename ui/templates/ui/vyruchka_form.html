{% extends "ui/base.html" %}
{% block title %}{{ title }}{% endblock %}

{% block content %}
<style>
  .soft-card { border: 1px solid rgba(255,255,255,.08); border-radius: 16px; }
  .soft-card .card-header { background: rgba(255,255,255,.03); border-bottom: 1px solid rgba(255,255,255,.08); }
  .btn-icon { display: inline-flex; align-items: center; gap: .4rem; }
  .hint { font-size: .875rem; opacity: .75; }

  /* form.as_p */
  form.card p { margin-bottom: .9rem; }
  form.card label { font-weight: 600; margin-bottom: .35rem; }
  form.card input, form.card select, form.card textarea { border-radius: 12px; }
  form.card .helptext { display:block; margin-top:.25rem; opacity:.75; font-size:.875rem; }
  form.card ul.errorlist { list-style:none; padding-left:0; margin:.35rem 0 0; }
  form.card ul.errorlist li { color:#ffb4b4; font-size:.9rem; }

  /* –ø–æ–∑–∏—Ü–∏–∏ */
  .table thead th { font-weight: 600; }
  .table tbody tr:hover { transform: translateY(-1px); transition: .12s ease; }
</style>

<div class="d-flex align-items-center justify-content-between mb-3">
  <div>
    <h3 class="m-0">{{ title }}</h3>
    <div class="hint">–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –∏ –¥–æ–±–∞–≤—å—Ç–µ –ø–æ–∑–∏—Ü–∏–∏</div>
  </div>
  <span class="badge rounded-pill bg-primary-subtle text-primary border border-primary-subtle">
    –§–æ—Ä–º–∞
  </span>
</div>

<form method="post" class="card soft-card shadow-sm">
  {% csrf_token %}

  <div class="card-header py-3">
    <div class="fw-semibold">–û—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</div>
  </div>

  <div class="card-body">
    {{ form.as_p }}
  </div>

  <div class="card-header py-3">
    <div class="d-flex align-items-center justify-content-between">
      <div class="fw-semibold">–ü–æ–∑–∏—Ü–∏–∏</div>
      <span class="text-muted small">–ú–æ–∂–Ω–æ –æ—Ç–º–µ—á–∞—Ç—å –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ</span>
    </div>
  </div>

  <div class="card-body pt-3">
    {{ formset.management_form }}

    <div class="table-responsive">
      <table class="table table-hover align-middle mb-0">
        <thead>
          <tr class="text-nowrap">
            <th class="ps-3">–¢–æ–≤–∞—Ä</th>
            <th style="width: 180px;" class="text-end">–ö–æ–ª-–≤–æ</th>
            <th style="width: 140px;" class="text-center pe-3">–£–¥–∞–ª–∏—Ç—å</th>
          </tr>
        </thead>
        <tbody>
          {% for f in formset %}
          <tr>
            <td class="ps-3">{{ f.id_tovar }}</td>
            <td class="text-end">{{ f.kolichestvo }}</td>
            <td class="text-center pe-3">
              {% if f.instance.pk %}
                <div class="form-check d-inline-flex align-items-center gap-2 m-0">
                  {{ f.DELETE }}
                  <label class="form-check-label text-muted small">—É–¥–∞–ª–∏—Ç—å</label>
                </div>
              {% else %}
                <span class="text-muted">‚Äî</span>
              {% endif %}
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <div class="card-footer bg-transparent border-0 pt-0 pb-3 px-3">
    <div class="d-flex flex-wrap gap-2">
      <button class="btn btn-primary btn-icon" type="submit">
        <span aria-hidden="true">üíæ</span><span>–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</span>
      </button>
      <a class="btn btn-outline-secondary btn-icon" href="javascript:history.back()">
        <span aria-hidden="true">‚Ü©Ô∏è</span><span>–ù–∞–∑–∞–¥</span>
      </a>
    </div>
  </div>
</form>
{% endblock %}
